package com.golan.local.dataflow.controllers;

import com.fasterxml.jackson.databind.ObjectMapper;
import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@SuppressWarnings("unused")
@RequestMapping("/v1/data/")
@RestController
@Slf4j
public class DfqlController {
    private static final ObjectMapper mapper = new ObjectMapper();
    @PostMapping(value = "_/~{envUuid}")
    public String getStreams(@PathVariable("envUuid") String envUuid,
                             @RequestParam(value = "revision", required = false) String revision) {
        return  "{\"titles\":[\"object_id\",\"timestamp\",\"stream_id\",\"value\"],\"data\":[[\"3271015924\",1619077798236,\"vtsEvent\",99],[\"3271015924\",1619077798236,\"voiceCallIsActive\",\"false\"],[\"3271015924\",1619077798236,\"vinSource\",\"device\"],[\"3271015924\",1619077798236,\"vehicleSpeed\",0.0],[\"3271015924\",1619077798236,\"updateTime\",\"2021-04-22T07:49:55.000Z\"],[\"3271015924\",1619077798236,\"twoDimFix\",\"false\"],[\"3271015924\",1619077798236,\"tripOdometer\",0.011],[\"3271015924\",1619077798236,\"tripFuelConsumption\",0.0],[\"3271015924\",1619077798236,\"timeofFix\",\"1970-01-01T00:00:00.000Z\"],[\"3271015924\",1619077798236,\"timeStamp\",\"2021-04-22T07:49:55.000Z\"],[\"3271015924\",1619077798236,\"timeFromPowerUp\",520.0],[\"3271015924\",1619077798236,\"throttlePosition\",0.0],[\"3271015924\",1619077798236,\"speed\",0.0],[\"3271015924\",1619077798236,\"spare\",0.0],[\"3271015924\",1619077798236,\"serviceType\",1],[\"3271015924\",1619077798236,\"satellites\",0.0],[\"3271015924\",1619077798236,\"routingEnabled\",\"false\"],[\"3271015924\",1619077798236,\"rollspeed\",0.0],[\"3271015924\",1619077798236,\"roaming\",\"false\"],[\"3271015924\",1619077798236,\"responseRedirectionEnabled\",\"false\"],[\"3271015924\",1619077798236,\"region\",\"US-W2\"],[\"3271015924\",1619077798236,\"rawData\",\"8305327101592401010102002160812aa300000000000000000000000000000000000000000000004c0064ff928f0000083283610067ffd9eb7fffffff000000000000000000000000000000000000000000004e84000001c700000480000034300000001000000405000000460000047000001e4a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014d50000001100000000000000000000020800003166\"],[\"3271015924\",1619072833625,\"proto\",\"5\"],[\"3271015924\",1619077798236,\"processedAt\",\"2021-04-22T07:49:57.935Z\"],[\"3271015924\",1619077798236,\"predicted\",\"false\"],[\"3271015924\",1619077798236,\"phoneNumber\",\"19148240146\"],[\"3271015924\",1619072833625,\"params\",\"0,1,2,4,7,8,9,11,13,14,18,19,37,38,39,41,44,45,47,50,51,52,53,54,59,60,61,100,101,102,103,20\"],[\"3271015924\",1619077798236,\"optionsExtensionEnabled\",\"true\"],[\"3271015924\",1619077798236,\"odometer\",12.49],[\"3271015924\",1619077798236,\"networkService\",\"true\"],[\"3271015924\",1619077798236,\"mobileIdTypeEnabled\",\"false\"],[\"3271015924\",1619077798236,\"mobileIdEnabled\",\"true\"],[\"3271015924\",1619077798236,\"mobileIDType\",1],[\"3271015924\",1619077798236,\"mobileID\",\"3271015924\"],[\"3271015924\",1619077798236,\"messageType\",2.0],[\"3271015924\",1619077798236,\"messageSequenceNumber\",33],[\"3271015924\",1619077798236,\"m2xDeviceID\",\"bcfd7491132b753a9bf8f226bb5571da\"],[\"3271015924\",1619077798236,\"lostExternalPower\",\"false\"],[\"3271015924\",1619077798236,\"locationFlag\",\"L\"],[\"3271015924\",1619077798236,\"location\",{\"longitude\":0.0,\"latitude\":0.0,\"elevation\":null,\"geohash\":\"s00000000000\"}],[\"3271015924\",1619077798236,\"lmu32HttpOtaUpdateStatusError\",\"false\"],[\"3271015924\",1619077798236,\"lgpDate\",\"1970-01-01T00:00:00.000Z\"],[\"3271015924\",1619077798236,\"lastKnown\",\"true\"],[\"3271015924\",1619077798236,\"invalidTime\",\"true\"],[\"3271015924\",1619077798236,\"input7\",\"false\"],[\"3271015924\",1619077798236,\"input6\",\"false\"],[\"3271015924\",1619077798236,\"input5\",\"false\"],[\"3271015924\",1619077798236,\"input4\",\"false\"],[\"3271015924\",1619077798236,\"input3\",\"false\"],[\"3271015924\",1619077798236,\"input2\",\"false\"],[\"3271015924\",1619077798236,\"input1\",\"false\"],[\"3271015924\",1619077798236,\"indicator1\",1029.0],[\"3271015924\",1619077798236,\"indicator0\",16.0],[\"3271015924\",1619072833625,\"indctrs\",\"0(00000000010010),1(0111110000000111)\"],[\"3271015924\",1619077798236,\"idleTime\",0.0],[\"3271015924\",1619077798236,\"historic\",\"false\"],[\"3271015924\",1619077798236,\"heading\",0.0],[\"3271015924\",1619077798236,\"gpsReceiverTrackingError\",\"true\"],[\"3271015924\",1619077798236,\"gpsReceiverSelfTestError\",\"false\"],[\"3271015924\",1619077798236,\"gpsInvalidFix\",\"true\"],[\"3271015924\",1619077798236,\"gpsAntennaStatusError\",\"false\"],[\"3271015924\",1619077798236,\"fuelLevelVolume\",53.33],[\"3271015924\",1619077798236,\"forwardingEnabled\",\"false\"],[\"3271015924\",1619077798236,\"firmwareScriptVersion\",41.254],[\"3271015924\",1619077798236,\"firmware\",\"2.4.2.15\"],[\"3271015924\",1619077798236,\"eventIndex\",50],[\"3271015924\",1619077798236,\"engineSpeed\",0.0],[\"3271015924\",1619077798236,\"engineRunTime\",70.0],[\"3271015924\",1619077798236,\"engineOilTemp\",1136.0],[\"3271015924\",1619077798236,\"engineCoolantTemp\",161.6],[\"3271015924\",1619077798236,\"distanceTravelledSinceLastPowerWakeUp\",0.0],[\"3271015924\",1619077798236,\"differntiallyCorrected\",\"false\"],[\"3271015924\",1619077798236,\"deviceType\",\"3040\"],[\"3271015924\",1619077798236,\"deviceInputIgnition\",\"false\"],[\"3271015924\",1619077798236,\"derivedMileage\",0.0],[\"3271015924\",1619077798236,\"dataService\",\"true\"],[\"3271015924\",1619077798236,\"connected\",\"true\"],[\"3271015924\",1619077798236,\"complete\",\"false\"],[\"3271015924\",1619077798236,\"clientId\",\"IOT\"],[\"3271015924\",1619077798236,\"carrier\",100],[\"3271015924\",1619077798236,\"calculatedFuelUsage\",0.0],[\"3271015924\",1619077798236,\"calAmpEventCode\",131],[\"3271015924\",1619077798236,\"batteryVoltageFrom12V\",12.6],[\"3271015924\",1619077798236,\"batteryVoltage\",13.36],[\"3271015924\",1619077798236,\"available\",\"true\"],[\"3271015924\",1619077798236,\"authenticationWordEnabled\",\"false\"],[\"3271015924\",1619077798236,\"assetIdentifier\",\"1FDUF5GT0MEC74414\"],[\"3271015924\",1619077798236,\"alwaysEnabled\",\"true\"],[\"3271015924\",1619077798236,\"altitude\",0.0],[\"3271015924\",1619077798236,\"accums\",97],[\"3271015924\",1619077798236,\"UMTS\",\"false\"],[\"3271015924\",1619077798236,\"TMPS2RB\",0.0],[\"3271015924\",1619077798236,\"TMPS2LB\",0.0],[\"3271015924\",1619077798236,\"TMPS1RA\",0.0],[\"3271015924\",1619077798236,\"TMPS1LA\",0.0],[\"3271015924\",1619077798236,\"RSSI\",-110.0],[\"3271015924\",1619077798236,\"MESSAGE_IN_BYTES\",370.0],[\"3271015924\",1619077798236,\"ICCID\",\"89011004300016396153\"],[\"3271015924\",1619077798236,\"HDOP\",0.0],[\"3271010534\",1619072836760,\"vtsEvent\",99],[\"3271010534\",1619072836760,\"voiceCallIsActive\",\"false\"],[\"3271010534\",1619072836760,\"vehicleSpeed\",0.0],[\"3271010534\",1619072836760,\"updateTime\",\"2021-04-22T06:27:13.000Z\"],[\"3271010534\",1619072836760,\"twoDimFix\",\"false\"],[\"3271010534\",1619072836760,\"tripOdometer\",0.0],[\"3271010534\",1619072836760,\"tripFuelConsumption\",0.0],[\"3271010534\",1619072836760,\"timeofFix\",\"1970-01-01T00:00:00.000Z\"],[\"3271010534\",1619072836760,\"timeStamp\",\"2021-04-22T06:27:13.000Z\"],[\"3271010534\",1619072836760,\"timeFromPowerUp\",300.0],[\"3271010534\",1619072836760,\"throttlePosition\",0.0],[\"3271010534\",1619072836760,\"speed\",0.0],[\"3271010534\",1619072836760,\"spare\",0.0],[\"3271010534\",1619072836760,\"serviceType\",1],[\"3271010534\",1619072836760,\"satellites\",0.0],[\"3271010534\",1619072836760,\"routingEnabled\",\"false\"],[\"3271010534\",1619072836760,\"rollspeed\",0.0],[\"3271010534\",1619072836760,\"roaming\",\"false\"],[\"3271010534\",1619072836760,\"responseRedirectionEnabled\",\"false\"],[\"3271010534\",1619072836760,\"region\",\"US-W2\"],[\"3271010534\",1619072836760,\"rawData\",\"830532710105340101010200126081174100000000000000000000000000000000000000000000004c0064ff8e8f0000082f82610067ffd9eb7fffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a940000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012c00002f80\"],[\"3271010534\",1619066630101,\"proto\",\"0\"],[\"3271010534\",1619072836760,\"processedAt\",\"2021-04-22T06:27:16.507Z\"],[\"3271010534\",1619072836760,\"predicted\",\"false\"],[\"3271010534\",1619066630101,\"params\",\"20\"],[\"3271010534\",1619072836760,\"optionsExtensionEnabled\",\"true\"],[\"3271010534\",1619072836760,\"odometer\",0.0],[\"3271010534\",1619072836760,\"networkService\",\"true\"],[\"3271010534\",1619072836760,\"mobileIdTypeEnabled\",\"false\"],[\"3271010534\",1619072836760,\"mobileIdEnabled\",\"true\"],[\"3271010534\",1619072836760,\"mobileIDType\",1],[\"3271010534\",1619072836760,\"mobileID\",\"3271010534\"],[\"3271010534\",1619072836760,\"messageType\",2.0],[\"3271010534\",1619072836760,\"messageSequenceNumber\",18],[\"3271010534\",1619072836760,\"m2xDeviceID\",\"e0247b024789c5e552a51dade1fd5edd\"],[\"3271010534\",1619072836760,\"lostExternalPower\",\"false\"],[\"3271010534\",1619072836760,\"locationFlag\",\"L\"],[\"3271010534\",1619072836760,\"location\",{\"longitude\":0.0,\"latitude\":0.0,\"elevation\":null,\"geohash\":\"s00000000000\"}],[\"3271010534\",1619072836760,\"lmu32HttpOtaUpdateStatusError\",\"false\"],[\"3271010534\",1619072836760,\"lgpDate\",\"1970-01-01T00:00:00.000Z\"],[\"3271010534\",1619072836760,\"lastKnown\",\"true\"],[\"3271010534\",1619072836760,\"invalidTime\",\"true\"],[\"3271010534\",1619072836760,\"input7\",\"false\"],[\"3271010534\",1619072836760,\"input6\",\"false\"],[\"3271010534\",1619072836760,\"input5\",\"false\"],[\"3271010534\",1619072836760,\"input4\",\"false\"],[\"3271010534\",1619072836760,\"input3\",\"false\"],[\"3271010534\",1619072836760,\"input2\",\"false\"],[\"3271010534\",1619072836760,\"input1\",\"false\"],[\"3271010534\",1619072836760,\"indicator1\",0.0],[\"3271010534\",1619072836760,\"indicator0\",0.0],[\"3271010534\",1619072836760,\"idleTime\",0.0],[\"3271010534\",1619072836760,\"historic\",\"false\"],[\"3271010534\",1619072836760,\"heading\",0.0],[\"3271010534\",1619072836760,\"gpsReceiverTrackingError\",\"true\"],[\"3271010534\",1619072836760,\"gpsReceiverSelfTestError\",\"false\"],[\"3271010534\",1619072836760,\"gpsInvalidFix\",\"true\"],[\"3271010534\",1619072836760,\"gpsAntennaStatusError\",\"false\"],[\"3271010534\",1619072836760,\"fuelLevelVolume\",0.0],[\"3271010534\",1619072836760,\"forwardingEnabled\",\"false\"],[\"3271010534\",1619072836760,\"firmwareScriptVersion\",41.254],[\"3271010534\",1619072836760,\"firmware\",\"2.4.2.15.0.7e0bf84-1001\"],[\"3271010534\",1619072836760,\"eventIndex\",47],[\"3271010534\",1619072836760,\"engineSpeed\",0.0],[\"3271010534\",1619072836760,\"engineRunTime\",0.0],[\"3271010534\",1619072836760,\"engineOilTemp\",0.0],[\"3271010534\",1619072836760,\"engineCoolantTemp\",32.0],[\"3271010534\",1619072836760,\"distanceTravelledSinceLastPowerWakeUp\",0.0],[\"3271010534\",1619072836760,\"differntiallyCorrected\",\"false\"],[\"3271010534\",1619072836760,\"deviceType\",\"3040\"],[\"3271010534\",1619072836760,\"deviceInputIgnition\",\"false\"],[\"3271010534\",1619072836760,\"derivedMileage\",0.0],[\"3271010534\",1619072836760,\"dataService\",\"true\"],[\"3271010534\",1619072836760,\"connected\",\"true\"],[\"3271010534\",1619072836760,\"complete\",\"false\"],[\"3271010534\",1619072836760,\"clientId\",\"IOT\"],[\"3271010534\",1619072836760,\"carrier\",100],[\"3271010534\",1619072836760,\"calculatedFuelUsage\",0.0],[\"3271010534\",1619072836760,\"calAmpEventCode\",130],[\"3271010534\",1619072836760,\"batteryVoltageFrom12V\",12.2],[\"3271010534\",1619072836760,\"batteryVoltage\",0.0],[\"3271010534\",1619072836760,\"available\",\"true\"],[\"3271010534\",1619072836760,\"authenticationWordEnabled\",\"false\"],[\"3271010534\",1619072836760,\"alwaysEnabled\",\"true\"],[\"3271010534\",1619072836760,\"altitude\",0.0],[\"3271010534\",1619072836760,\"accums\",97],[\"3271010534\",1619072836760,\"UMTS\",\"false\"],[\"3271010534\",1619072836760,\"TMPS2RB\",0.0],[\"3271010534\",1619072836760,\"TMPS2LB\",0.0],[\"3271010534\",1619072836760,\"TMPS1RA\",0.0],[\"3271010534\",1619072836760,\"TMPS1LA\",0.0],[\"3271010534\",1619072836760,\"RSSI\",-114.0],[\"3271010534\",1619072836760,\"MESSAGE_IN_BYTES\",370.0],[\"3271010534\",1619072836760,\"ICCID\",\"89011003300016530745\"],[\"3271010534\",1619072836760,\"HDOP\",0.0]],\"resultMetadata\":{}}";
    }

    @GetMapping(value = "_/~{envUuid}")
    public String getStreamsValues(@PathVariable("envUuid") String envUuid,
                                   @RequestParam(value = "query", required = false) String revision) {
        return "{\"titles\":[\"_timestamp\",\"_object_id\",\"speed\"],\"data\":[[1619362838377,\"3271015924\",0.0],[1619276273735,\"3271015924\",0.0],[1619276011316,\"3271015924\",0.0],[1619275999436,\"3271015924\",0.0],[1619189443013,\"3271015924\",0.0],[1619188988450,\"3271015924\",0.0],[1619188981800,\"3271015924\",0.89],[1619188975764,\"3271015924\",1.41],[1619188972755,\"3271015924\",0.0],[1619188969780,\"3271015924\",2.75],[1619188966761,\"3271015924\",1.63],[1619188964770,\"3271015924\",0.0],[1619188959940,\"3271015924\",5.23],[1619188936889,\"3271015924\",9.55],[1619188902877,\"3271015924\",12.01],[1619188865925,\"3271015924\",13.42],[1619188850687,\"3271015924\",10.67],[1619188850559,\"3271015924\",0.0],[1619188850410,\"3271015924\",0.0],[1619188850283,\"3271015924\",0.0],[1619188850157,\"3271015924\",0.0],[1619182239562,\"3271015924\",0.0],[1619181784324,\"3271015924\",0.0],[1619181770326,\"3271015924\",1.3],[1619181735236,\"3271015924\",12.46],[1619181720316,\"3271015924\",9.75],[1619181711325,\"3271015924\",6.35],[1619181690363,\"3271015924\",0.0],[1619181600328,\"3271015924\",0.0],[1619181570331,\"3271015924\",0.0],[1619181480232,\"3271015924\",0.0],[1619181450319,\"3271015924\",0.0],[1619181434371,\"3271015924\",3.15],[1619181358227,\"3271015924\",10.74],[1619181351990,\"3271015924\",2.48],[1619181351872,\"3271015924\",0.0],[1619181351752,\"3271015924\",0.0],[1619181351640,\"3271015924\",0.0],[1619181351532,\"3271015924\",0.0],[1619179999535,\"3271015924\",0.0],[1619179545055,\"3271015924\",0.0],[1619179418407,\"3271015924\",3.56],[1619179412513,\"3271015924\",6.02],[1619179339518,\"3271015924\",1.54],[1619178470965,\"3271015924\",0.0],[1619178178857,\"3271015924\",0.0],[1619177771437,\"3271015924\",5.32],[1619177771320,\"3271015924\",1.99],[1619177771203,\"3271015924\",1.68],[1619177771074,\"3271015924\",0.0],[1619177770954,\"3271015924\",0.0],[1619177770829,\"3271015924\",0.0],[1619176101452,\"3271015924\",0.0],[1619175825701,\"3271015924\",0.0],[1619175825562,\"3271015924\",0.0],[1619172942163,\"3271015924\",0.0],[1619172487799,\"3271015924\",0.0],[1619172451334,\"3271015924\",0.0],[1619172423672,\"3271015924\",0.0],[1619172423550,\"3271015924\",0.0],[1619172423421,\"3271015924\",0.0],[1619146705091,\"3271015924\",0.0],[1619146441425,\"3271015924\",0.0],[1619146430333,\"3271015924\",0.0],[1619127565317,\"3271015924\",0.0],[1619127290096,\"3271015924\",0.0],[1619127289774,\"3271015924\",0.0],[1619125027239,\"3271015924\",0.0],[1619124602422,\"3271015924\",0.0],[1619124572233,\"3271015924\",0.0],[1619124567421,\"3271015924\",0.0],[1619124544540,\"3271015924\",0.0],[1619124541770,\"3271015924\",0.0],[1619124541489,\"3271015924\",0.0],[1619124541198,\"3271015924\",0.0],[1619124069906,\"3271015924\",0.0],[1619123615311,\"3271015924\",0.0],[1619122788595,\"3271015924\",0.0],[1619122692700,\"3271015924\",0.0],[1619122475015,\"3271015924\",0.0],[1619122199998,\"3271015924\",0.0],[1619121739133,\"3271015924\",0.0],[1619121464258,\"3271015924\",0.0],[1619119568465,\"3271015924\",0.0],[1619119291879,\"3271015924\",0.0],[1619119105205,\"3271015924\",0.0],[1619118830201,\"3271015924\",0.0],[1619118045750,\"3271015924\",0.0],[1619117590883,\"3271015924\",0.0],[1619117265874,\"3271015924\",0.0],[1619117159613,\"3271015924\",0.0],[1619116958527,\"3271015924\",0.0],[1619116504090,\"3271015924\",0.0],[1619116400532,\"3271015924\",0.0],[1619116023692,\"3271015924\",0.0],[1619115566097,\"3271015924\",0.0],[1619115417542,\"3271015924\",0.0],[1619115260260,\"3271015924\",0.0],[1619114852457,\"3271015924\",0.0],[1619114814479,\"3271015924\",0.0]],\"resultMetadata\":{\"from\":1618389296000,\"to\":1619596457447,\"limit\":100,\"nextCursor\":\"1619114814479\"}}";
    }
}